## Review Card 기능 플로우 

### 플로우 1: 테스트 진행 중 외부 영역 클릭

**1. 입력**
* 사용자가 `ReviewTestModal`의 컨텐츠 영역 바깥(배경)을 클릭합니다.

**2. 처리**
* 시스템은 `ReviewTestModal` 외부 영역에 대한 클릭 이벤트를 감지합니다.
* 시스템은 즉시 `ReviewTestModal`을 닫지 않고, `ConfirmModal`(종료 확인 모달)을 열도록 트리거합니다.

**3. 출력**
* `ReviewTestModal` 위에 `ConfirmModal`이 표시됩니다.
* 이 모달은 사용자에게 테스트를 정말로 종료할 것인지 확인하는 내용을 담고 있습니다.
`
`

### 플로우 2: Evaluation View에서 결과(성공/실패) 입력

**1. 입력**
* 사용자가 evaluation view의 하단 공통 영역에 있는 '실패' 혹은 '성공' 버튼 중 하나를 클릭합니다.

**2. 처리**
* 시스템은 클릭된 버튼('실패' 또는 '성공')을 식별하고, `failCount` 또는 `successCount`를 1 증가시킵니다.
* 시스템은 다음 질문이 존재하는지 확인합니다.
    * **(분기 1) 다음 질문이 있는 경우:** 다음 질문 데이터를 로드하고, Input view로 전환할 준비를 합니다.
    * **(분기 2) 다음 질문이 없는 경우:** result view에 필요한 결과 데이터를 준비하고, 모달 내 화면을 result view로 전환할 준비를 합니다.

**3. 출력 및 사이드 이펙트**
* **(분기 1 출력):** `ReviewTestModal` 내의 화면이 다음 질문에 대한 Input view로 전환됩니다. 데이터베이스의 `ReviewCard` 레코드에 카운트가 업데이트됩니다.
* **(분기 2 출력):** "TEST가 종료되었습니다."라는 토스트 알림이 표시되고, `ReviewTestModal` 내부 화면만 result view로 전환됩니다. 데이터베이스의 `ReviewCard` 레코드에 카운트가 업데이트됩니다.
* **엣지 케이스:** 버튼 중복 클릭을 방지하고, 데이터 업데이트 실패 시 오류 메시지를 표시하며 이전 상태를 유지합니다.
`
`

### 플로우 3: Result View에서 특정 질문 삭제

**1. 입력**
* 사용자가 result view 좌측의 질문 목록에서 특정 질문 옆에 있는 '삭제하기' 버튼을 클릭합니다.

**2. 처리**
* 시스템은 삭제할 질문을 식별하고 삭제 확인을 위한 `ConfirmModal`을 띄웁니다.
* 사용자가 확인을 선택하면:
    * 임시 상태에서 해당 질문을 제거합니다.
    * 질문 목록이 비어있는지 확인합니다.
    * 만약 마지막 질문이어서 목록이 비게 되면, 해당 `ReviewCard` 전체를 삭제 대상으로 표시합니다.

**3. 출력 및 사이드 이펙트**
* 삭제가 확인되면 `ConfirmModal`이 닫히고 화면의 질문 목록에서 해당 항목이 사라집니다.
* 만약 마지막 질문이었다면, "모든 질문이 삭제되었습니다. 저장 시 이 카드는 영구히 삭제됩니다."와 같은 안내 메시지를 사용자에게 표시합니다.
* 모든 변경사항은 최종 '저장하기' 전까지 로컬 상태에만 저장됩니다.
`
`

### 플로우 4: Result View에서 설정 변경 및 최종 저장

**1. 입력**
* 사용자가 우측 설정 패널에서 '복습주기', '중요도' 등을 변경하거나, 하단의 '저장하기' 버튼을 클릭합니다.

**2. 처리**
* 설정값 변경은 result view의 임시 로컬 상태에 저장됩니다.
* '저장하기' 버튼을 클릭하면, 시스템은 로컬 상태의 모든 변경사항(설정값, 삭제 질문 목록, 카드 전체 삭제 여부)을 종합하여 서버에 요청을 보냅니다.
    * **(분기 1) `ReviewCard`가 전체 삭제 대상인 경우:** 서버에 `ReviewCard`의 삭제를 요청합니다.
    * **(분기 2) `ReviewCard`가 유지되는 경우:** 서버에 `ReviewCard`의 업데이트를 요청합니다. (변경된 설정, 삭제될 질문, `isActive: false` 상태 포함)

**3. 출력 및 사이드 이펙트**
* **(요청 성공 시):** "저장되었습니다." 토스트 알림이 표시되고 `ReviewTestModal`이 닫힙니다. 데이터베이스에 모든 변경사항이 영구 저장됩니다.
* **(요청 실패 시):** 오류 메시지가 표시되며, `ReviewTestModal`은 닫히지 않고 모든 수정사항이 유지되어 재시도가 가능합니다.
* **엣지 케이스:** 사용자가 아무것도 변경하지 않고 '저장하기'를 클릭해도, `isActive` 상태를 `false`로 변경하는 업데이트를 처리하고 테스트를 정상적으로 종료시킵니다.
`
`