# 기술 요구사항 문서 (TRD)

## 1. 기술 요약
- **프로젝트 개요**: AlgoRevise는 React 기반 프론트엔드와 Spring Boot 기반 백엔드를 사용하여 AI 기반 알고리즘 오답 관리 플랫폼을 구축합니다. 사용자가 업로드한 알고리즘 문제의 풀이 흐름을 AI가 분석하고 시각화하며, 사용자는 약점 구간을 선택하여 AI 챗봇의 심층 분석 및 맞춤형 테스트 문제를 제공받습니다. Spring Security를 통해 보안을 강화하고, Spring Data JPA를 사용하여 데이터베이스와 효율적으로 상호 작용합니다. Firebase Storage를 사용하여 문제와 관련된 파일들을 저장하고, Lemon Squeezy를 통해 구독 및 결제 기능을 구현합니다.
- **핵심 기술 스택**: React, TypeScript, Tailwind CSS, Spring Boot, Spring Security, Spring Data JPA, MySQL, Firebase Storage, Lemon Squeezy, Clerk
- **주요 기술 목표**:
    -   빠른 응답 속도와 안정적인 서비스 제공
    -   확장 가능한 아키텍처 설계
    -   높은 수준의 보안 유지
- **주요 기술 가정**:
    -   AI 분석 모델의 정확도가 80% 이상을 유지할 수 있다고 가정합니다.
    -   사용자 트래픽이 예측 가능하며, 필요시 확장 가능하도록 설계합니다.
    -   외부 API(Lemon Squeezy, Firebase)의 안정적인 작동을 가정합니다.

## 2. 기술 스택

| 범주                | 기술 / 라이브러리           | 이유                                                                                  |
| ------------------- | --------------------------- | ------------------------------------------------------------------------------------- |
| 프론트엔드            | React                      | 컴포넌트 기반의 UI 개발에 용이하며, TypeScript와 함께 사용하여 안정성과 개발 효율성을 높입니다. |
| UI 프레임워크         | TypeScript, Tailwind CSS   | TypeScript로 코드의 안정성을 높이고, Tailwind CSS로 빠르고 일관된 UI 스타일링이 가능합니다.          |
| 백엔드                | Spring Boot                | Java 기반의 엔터프라이즈 애플리케이션 개발에 최적화되어 있으며, 빠른 개발과 배포를 지원합니다.   |
| 인증/회원가입         | Clerk                      | 소셜 로그인(구글 등) 및 인증 플로우를 신속하게 구현할 수 있는 인증 서비스입니다.           |
| 보안                  | Spring Security            | 강력한 인증 및 권한 부여 기능을 제공하여 애플리케이션의 보안을 강화합니다.                |
| 데이터베이스 액세스     | Spring Data JPA           | 데이터베이스와의 상호 작용을 단순화하고, ORM을 통해 객체와 데이터베이스 간의 매핑을 쉽게 관리합니다.   |
| 데이터베이스            | MySQL                      | 안정적이고 널리 사용되는 오픈 소스 관계형 데이터베이스입니다.                             |
| 파일 스토리지         | Firebase Storage           | 이미지, 비디오, 오디오 및 기타 사용자 생성 콘텐츠와 같은 파일을 저장하고 제공하는 데 사용됩니다. |
| 결제                  | Lemon Squeezy              | 구독, 라이선스 및 일회성 결제에 대한 안전하고 사용하기 쉬운 결제 솔루션입니다.               |
| AI 분석               | Gemini API + Prompt Engineering     | Gemini API와 프롬프트 엔지니어링을 활용하여 알고리즘 문제 분석 및 맞춤 문제 출제를 수행합니다. |
| API                   | RESTful API                | 프론트엔드와 백엔드 간의 통신을 위한 표준 인터페이스입니다.                              |
| 빌드 도구             | Vite                      | React 프론트엔드(대시보드, 랜딩페이지) 개발 및 번들링, 모노레포 환경에서 빠른 개발 경험을 제공합니다. |
| 빌드 도구(백엔드)      | Maven/Gradle               | Spring Boot 백엔드 빌드 및 의존성 관리를 위해 사용합니다.                                     |
| CI/CD               | Jenkins/GitHub Actions     | 코드 변경 사항을 자동으로 테스트하고 배포하여 개발 프로세스를 간소화합니다.                 |

## 3. 시스템 아키텍처 설계

### Monorepo 전략
- 본 프로젝트는 여러 앱(백엔드, 대시보드, 랜딩페이지)과 공통 라이브러리(lib)를 하나의 저장소에서 관리하는 Monorepo 방식을 사용합니다.
- 각 앱(apps 폴더)은 독립적으로 개발·배포할 수 있으며, libs 폴더에는 공통 타입, 비즈니스 로직, UI 컴포넌트가 포함되어 코드 재사용성과 일관성을 확보합니다.
- Monorepo 환경은 협업 및 CI/CD, 버전 일관성 관리, 공통 자산 활용에 유리합니다.

### 최상위 구성 요소
- **프론트엔드 (React + Clerk)**: 사용자 인터페이스를 제공하고, Clerk를 활용하여 소셜 로그인(구글) 및 회원가입 기능을 제공합니다.
    -   컴포넌트: Google 회원가입/로그인 UI(Clerk), 문제 등록 폼, 풀이 흐름 시각화, 챗봇 인터페이스, 맞춤 문제 풀이 환경, 학습 통계 대시보드
    -   상태 관리: Redux 또는 Context API를 사용하여 애플리케이션 상태를 관리합니다.
- **백엔드 (Spring Boot)**: API 엔드포인트를 제공하고 비즈니스 로직을 처리하며 데이터베이스와 상호 작용합니다.
    -   API 컨트롤러: 문제 등록, AI 분석 요청, 챗봇 질의, 맞춤 문제 요청, 결제 처리 등을 위한 API 제공
    -   서비스 레이어: 비즈니스 로직 구현 (AI 분석 연동, 맞춤 문제 생성, 사용자 관리, 결제 처리)
    -   데이터 액세스 레이어: Spring Data JPA를 사용하여 데이터베이스와 상호 작용
- **AI 분석 서비스 (Gemini API 기반)**: 알고리즘 문제 분석 및 맞춤 문제 생성을 외부 Gemini API를 활용하여 처리합니다.
    -   프롬프트 엔지니어링: Gemini API 호출 시 최적의 결과를 얻기 위해 다양한 프롬프트 전략을 적용합니다.
    -   문제 분석 로직: Gemini API를 통해 문제의 코드 흐름 분석 및 약점 식별을 수행합니다.
    -   맞춤 문제 생성 로직: Gemini API와 프롬프트를 활용해 사용자 약점에 맞는 문제를 생성합니다.
- **데이터베이스 (MySQL)**: 사용자 정보, 문제 정보, 풀이 기록, 결제 정보 등을 저장합니다.
    -   스키마 설계: 사용자, 문제, 풀이, 결제 테이블 설계
    -   데이터 액세스 최적화: 쿼리 최적화 및 인덱싱
- **파일 스토리지 (Firebase Storage)**: 사용자가 업로드한 코드 파일 및 기타 관련 파일을 저장합니다.
    -   파일 업로드 API: 사용자가 파일을 업로드할 수 있는 API 제공
    -   파일 접근 권한 관리: 사용자별 파일 접근 권한 설정

### 최상위 컴포넌트 상호 작용 다이어그램

```mermaid
graph TD
    A[Frontend (React)] --> B(Backend (Spring Boot))
    B --> C{Database (MySQL)}
    B --> D[AI 분석 서비스 (Gemini API)]
    B --> E[Firebase Storage]
    B --> F[Lemon Squeezy]

-   **Frontend (React) -> Backend (Spring Boot)**: 프론트엔드는 API 요청을 통해 백엔드와 통신합니다. 문제 등록, AI 분석 요청, 챗봇 질의, 맞춤 문제 요청, 결제 처리 등의 작업을 수행합니다.
-   **Backend (Spring Boot) -> Database (MySQL)**: 백엔드는 Spring Data JPA를 통해 데이터베이스와 상호 작용합니다. 사용자 정보, 문제 정보, 풀이 기록, 결제 정보 등을 저장하고 조회합니다.
-   **Backend (Spring Boot) -> AI 분석 서버**: 백엔드는 AI 분석 서버에 문제 분석 및 맞춤 문제 생성을 요청합니다.
-   **Backend (Spring Boot) -> Firebase Storage**: 백엔드는 Firebase Storage에 사용자가 업로드한 코드 파일 및 기타 관련 파일을 저장하고 접근합니다.
-   **Backend (Spring Boot) -> Lemon Squeezy**: 백엔드는 Lemon Squeezy API를 통해 구독 및 결제 처리를 수행합니다.

### 코드 구성 및 규칙

**도메인 기반 조직 전략**
- **도메인 분리**: 사용자 관리, 문제 관리, AI 분석, 결제 처리 등 비즈니스 도메인별로 코드를 분리합니다.
- **계층 기반 아키텍처**: 프레젠테이션 (React 컴포넌트), 비즈니스 로직 (Spring 서비스), 데이터 액세스 (Spring Data JPA 레포지토리), 인프라 (외부 API 연동) 계층으로 분리합니다.
- **기능 기반 모듈**: 사용자 인증, 문제 등록, AI 분석, 결제 처리 등 관련 기능을 함께 그룹화합니다.
- **공유 컴포넌트**: 공통 유틸리티, 타입, 재사용 가능한 컴포넌트를 전용 공유 모듈에 배치합니다.

**백엔드 Spring Boot 아키텍처 규칙**
- **Package-by-Feature 구조**: 기능별로 패키지를 구성하여 관련 컴포넌트(controller, service, dto, repository, domain)를 함께 배치
- **중앙집중식 예외 처리**: `@RestControllerAdvice`를 사용한 글로벌 예외 핸들러 구현, 비즈니스 로직에서는 `try-catch` 사용 금지
- **DTO 사용 원칙**: Controller에서 Entity 객체 직접 사용 금지, 모든 Request/Response는 DTO를 통해 처리
- **의존성 주입**: 필드 주입 금지, 생성자 주입만 사용 (`@RequiredArgsConstructor` + `final` 키워드 권장)
- **RESTful API 설계**: 리소스 중심의 명사형 URI 사용, HTTP 메서드로 CRUD 작업 표현

**범용 파일 및 폴더 구조**
/
├── apps/
│   ├── backend/                # Spring Boot 백엔드 서비스 (API 서버)
│   ├── dashboard/              # React 기반 관리자/대시보드 사이트 (Vite 기반)
│   └── landing-page/           # React 기반 랜딩 페이지 (Vite 기반)
├── libs/
│   ├── api-types/              # 백엔드 API 요청/응답용 TypeScript 타입 정의
│   ├── core-logic/             # 공통 비즈니스 로직, 유틸 함수 (format, validation 등)
│   └── ui-components/          # 공통 React UI 컴포넌트 (Button, Input 등)
├── database/                   # 데이터베이스 스크립트 및 설정
│   └── schema.sql              # 데이터베이스 스키마 정의
├── .env                        # 환경 변수 파일
├── README.md                   # 프로젝트 설명 및 설정 방법
└── LICENSE                     # 라이선스 정보

### 데이터 흐름 및 통신 패턴
- **클라이언트-서버 통신**: 프론트엔드는 RESTful API를 통해 백엔드와 통신합니다. API 요청/응답 패턴을 사용합니다.
- **데이터베이스 상호 작용**: Spring Data JPA를 사용하여 데이터베이스와 상호 작용합니다. ORM을 통해 객체와 데이터베이스 간의 매핑을 관리합니다.
- **외부 서비스 통합**: Clerk(구글 소셜 로그인 등), Lemon Squeezy API, Firebase Storage API를 사용하여 외부 서비스와 통합합니다. API 키 및 인증 정보를 안전하게 관리합니다.
- **실시간 통신**: 필요에 따라 WebSocket 또는 SSE (Server-Sent Events)를 사용하여 실시간 업데이트를 제공할 수 있습니다. (예: 챗봇 메시지 전송)
- **데이터 동기화**: 분산된 컴포넌트 간의 데이터 일관성을 유지하기 위해 트랜잭션 관리 및 데이터 동기화 전략을 적용합니다.

## 4. 성능 및 최적화 전략

- **데이터베이스 쿼리 최적화**: 쿼리 성능 분석 도구를 사용하여 느린 쿼리를 식별하고 인덱싱 및 쿼리 재작성을 통해 최적화합니다.
- **캐싱**: 자주 액세스하는 데이터를 캐싱하여 데이터베이스 부하를 줄이고 응답 시간을 단축합니다. (예: Redis)
- **코드 최적화**: 불필요한 연산을 제거하고 알고리즘 효율성을 개선하여 코드 실행 속도를 높입니다.
- **로드 밸런싱**: 트래픽이 증가할 경우 로드 밸런서를 사용하여 여러 서버에 트래픽을 분산시켜 시스템 부하를 줄입니다.
- **CDN (콘텐츠 전송 네트워크)**: 정적 자산 (이미지, CSS, JavaScript 파일)을 CDN에 배포하여 사용자에게 더 빠르게 제공합니다.
- **AI 모델 최적화**: AI 분석 모델의 추론 속도를 높이기 위해 모델 경량화, 양자화, GPU 가속 등의 기술을 적용합니다.

## 5. 구현 로드맵 및 마일스톤

### 1단계: 기반 (MVP 구현)
- **핵심 인프라**: 기본 시스템 설정 및 필수 구성 요소 구축 (React, Spring Boot, MySQL, Firebase Storage, Lemon Squeezy 연동)
- **필수 기능**: 문제 등록, AI 분석, 약점 선택 UI, 챗봇 심층 분석, 맞춤 문제 자동 출제 및 채점, 기본 통계 구현
- **기본 보안**: Spring Security를 사용한 인증 및 권한 부여 구현
- **개발 환경**: 개발 환경 설정 및 CI/CD 기본 설정
- **예상 완료 기간**: 3개월

### 2단계: 기능 개선
- **고급 기능**: 프리미엄 기능 (무제한 맞춤 문제, 고급 통계, 레벨·뱃지, 복습 캘린더 연동) 구현
- **성능 최적화**: 시스템 성능 개선 (데이터베이스 쿼리 최적화, 캐싱, 코드 최적화)
- **보안 강화**: 고급 보안 기능 구현 (취약점 분석 및 패치, 보안 감사)
- **모니터링 구현**: 시스템 모니터링 설정 및 로그 분석
- **예상 완료 기간**: 3개월

## 6. 위험 평가 및 완화 전략

### 기술적 위험 분석
- **기술 위험**: AI 분석 정확도 부족, 맞춤 문제 생성의 저작권 문제, 외부 API 의존성
- **성능 위험**: 트래픽 증가에 따른 시스템 성능 저하, AI 분석 서버의 응답 시간 지연
- **보안 위험**: SQL 인젝션, XSS 공격, 데이터 유출
- **통합 위험**: 외부 API (Lemon Squeezy, Firebase)의 장애 발생
- **완화 전략**:
    -   AI 모델 튜닝 및 데이터 증강을 통해 분석 정확도 향상
    -   자체 생성 문제 사용 및 저작권 검토
    -   외부 API 장애 대비 대체 API 또는 로컬 캐싱 구현
    -   로드 밸런싱 및 캐싱을 통해 시스템 성능 유지
    -   보안 취약점 점검 및 코드 검토, 보안 라이브러리 사용

### 프로젝트 인도 위험
- **일정 위험**: 개발 일정 지연, 외부 API 변경
- **자원 위험**: 팀 역량 부족, AI 엔지니어 부족
- **품질 위험**: 코드 품질 저하, 테스트 부족
- **배포 위험**: 배포 환경 문제, 롤백 실패
- **비상 계획**:
    -   일정 지연 시 기능 축소 또는 추가 인력 투입
    -   팀 역량 강화를 위한 교육 및 외부 전문가 자문
    -   코드 리뷰 및 자동화된 테스트 강화
    -   배포 전 철저한 테스트 및 롤백 계획 수립
